import{a as m,m as b}from"./Alert.c90547c0.js";import{v as y,c as C,S as l}from"./sweetalert2.all.c9172487.js";let f=1;const v=document.querySelector(".listado-citas");document.addEventListener("DOMContentLoaded",function(){L()});function L(){y(),h(),E(),$(),T(),w(),q(),C()}function h(){const i=document.querySelector(".mostrar");i&&i.classList.remove("mostrar"),document.querySelector(`#paso-${f}`).classList.add("mostrar");const o=document.querySelector(".actual");o&&o.classList.remove("actual"),document.querySelector(`[data-paso="${f}"]`).classList.add("actual")}function E(){document.querySelectorAll(".tabs button").forEach(e=>{e.addEventListener("click",function(o){f=parseInt(o.target.dataset.paso),h()})})}function $(){document.querySelector("#nombreCliente").textContent=localStorage.getItem("user")}function w(){document.querySelector("#fechaCita").addEventListener("input",async function(e){const o=e.target.value;try{const r=await(await fetch(`${m}/citasClientesAll?fecha=${o}`)).json();if(r.length===0)return v.innerHTML="",b("No hay citas en esta fecha","error",".listado-citas");g(r)}catch(c){console.log(c)}})}function g(i){v.innerHTML="";let e;i.forEach(o=>{const{cliente:c,precio:r,hora:t,servicio:d,telefono:u,id:a,email:p}=o;if(e!==a){const s=document.createElement("UL"),S=document.createElement("LI");s.classList.add("citas"),S.innerHTML=`
                <p>ID: <span>${a}</span></p>
                <p>Hora: <span>${t}</span></p>
                <p>Cliente: <span>${c}</span></p>
                <p>Correo: <span>${p}</span></p>
                <p>Telefono: <span>${u}</span></p>
                <h2>Servicios</h2>
            `,e=a,s.appendChild(S),v.appendChild(s)}const n=document.createElement("P");n.classList.add("servicioCita"),n.textContent=`${d} : ${r}`,console.log(r),v.appendChild(n)})}async function q(){try{const e=await(await fetch(`${m}/servicios`)).json();A(e)}catch(i){console.log(i)}}function A(i){i.forEach(e=>{const{id:o,nombre:c,precio:r}=e,t=document.createElement("DIV");t.classList.add("contenedor-datos");const d=document.createElement("P");d.classList.add("nombre-servicio"),d.textContent=c;const u=document.createElement("P");u.classList.add("precio-servicio"),u.textContent=`$${r}`,t.appendChild(d),t.appendChild(u);const a=document.createElement("DIV");a.classList.add("servicio-admin"),a.dataset.idServicio=o;const p=document.createElement("DIV"),n=document.createElement("BUTTON");n.classList.add("btn-editar"),n.textContent="Actualizar",n.onclick=function(){D(e)};const s=document.createElement("BUTTON");s.classList.add("btn-eliminar"),s.textContent="Eliminar",s.onclick=function(){x(e.id)},p.appendChild(n),p.appendChild(s),a.appendChild(t),a.appendChild(p),document.querySelector("#servicios").appendChild(a)})}async function T(){document.querySelector("#crear-servicio").addEventListener("click",async function(){const e=document.querySelector("#nombreServicio").value,o=document.querySelector("#precioServicio").value,c=new FormData;c.append("nombre",e),c.append("precio",o);try{const t=await(await fetch(`${m}/servicios`,{method:"POST",body:c})).json();console.log(t),t.tipo==="error"?b(t.msg,"error",".formulario"):l.fire("Muy bien!",t.mensaje,"success").then(()=>{window.location.reload()})}catch{l.fire({icon:"error",title:"Oops...",text:"Hubo un error al crear el servicio"})}})}async function x(i){try{const o=await(await fetch(`${m}/servicios/eliminar?id=${i}`,{method:"POST"})).json();o.tipo==="exito"&&l.fire("Muy bien!",o.mensaje,"success").then(()=>{window.location.reload()})}catch{l.fire({icon:"error",title:"Oops...",text:"Hubo un error al eliminar el servicio"})}}async function z(i){const e=document.querySelector("#nombreServicioActualizado").value,o=document.querySelector("#precioServicioActualizado").value,c=new FormData;c.append("nombre",e),c.append("precio",o);try{const t=await(await fetch(`${m}/servicios/actualizar?id=${i}`,{method:"POST",body:c})).json();t.tipo==="error"?b(t.msg,"error",".formulario"):l.fire("Muy bien!",t.respuesta.mensaje,"success").then(()=>{window.location.reload()})}catch{l.fire({icon:"error",title:"Oops...",text:"Hubo un error al actualizar el servicio"})}}async function D(i){const{nombre:e,precio:o,id:c}=i,r=document.createElement("DIV");r.classList.add("modal"),r.innerHTML=`
            <form class="formulario actualizar-servicio">
                <h2>Actualizar Servicio</h2>
                <div class="campo">
                    <label for="nombreServicio">Nombre</label>
                    <input type="text" id="nombreServicioActualizado" value="${e}" placeholder="Nombre de tu servicio" />
                </div>
                <div class="campo">
                    <label for="precioServicio">Precio</label>
                    <input type="number" value="${o}" id="precioServicioActualizado" placeholder="Precio de tu servicio" />
                </div>
                <div class="opciones">
                    <input type="submit" value="Actualizar" class="btn-editar" id="actualizar-servicio" />
                    <input type="button" value="Cancelar" class="btn-eliminar cerrar" id="precioServicio" />
                </div>
            </form>
        `,r.addEventListener("click",function(t){t.preventDefault(),t.target.classList.contains("cerrar")&&r.remove()}),r.addEventListener("click",function(t){t.preventDefault(),t.target.classList.contains("btn-editar")&&z(c)}),document.querySelector("body").appendChild(r)}
