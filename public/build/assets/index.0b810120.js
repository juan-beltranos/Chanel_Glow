import{m as d,a as p}from"./Alert.645a9844.js";import{S as f}from"./sweetalert2.all.5497c4f7.js";let l=null;const c={nombre:"",fecha:"",hora:"",servicios:[]};(function(e){e(document).ready(function(){function o(){e(window).width()>992?e(".navbar .dropdown").on("mouseover",function(){e(".dropdown-toggle",this).trigger("click")}).on("mouseout",function(){e(".dropdown-toggle",this).trigger("click").blur()}):e(".navbar .dropdown").off("mouseover").off("mouseout")}o(),e(window).resize(o)}),e(window).scroll(function(){e(this).scrollTop()>100?e(".back-to-top").fadeIn("slow"):e(".back-to-top").fadeOut("slow")}),e(".back-to-top").click(function(){return e("html, body").animate({scrollTop:0},1500,"easeInOutExpo"),!1}),e('[data-toggle="counter-up"]').counterUp({delay:10,time:2e3}),e("#date").datetimepicker({format:"L"}),e("#time").datetimepicker({format:"LT"}),e(".service-carousel").owlCarousel({autoplay:!0,smartSpeed:1500,loop:!0,dots:!1,nav:!1,responsive:{0:{items:1},576:{items:2},768:{items:3},992:{items:4},1200:{items:5}}}),e(".pricing-carousel").owlCarousel({autoplay:!0,smartSpeed:1500,margin:30,loop:!0,dots:!1,nav:!1,responsive:{0:{items:1},576:{items:1},768:{items:2}}}),e(".testimonial-carousel").owlCarousel({autoplay:!0,smartSpeed:1500,margin:30,dots:!0,loop:!0,items:1})})(jQuery);document.addEventListener("DOMContentLoaded",function(){v()});function v(){b(),S(),y(),L()}function h(e){return Number(e).toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,".")}function g(e){e.forEach(o=>{const{id:r,nombre:a,precio:t}=o,n=document.createElement("P");n.classList.add("nombre-servicio"),n.textContent=a;const s=document.createElement("P");s.classList.add("precio-servicio"),s.textContent=`$${h(t)}`;const i=document.createElement("DIV");i.classList.add("servicio"),i.dataset.idServicio=r,i.onclick=function(){w(o)},i.appendChild(n),i.appendChild(s),document.querySelector("#servicios").appendChild(i)})}function w(e){const{id:o}=e,{servicios:r}=c,a=document.querySelector(`[data-id-servicio="${o}"]`);r.some(t=>t.id===o)?(c.servicios=r.filter(t=>t.id!==o),a.classList.remove("seleccionado")):(c.servicios=[...r,e],a.classList.add("seleccionado"))}function y(){document.querySelector("#fecha").addEventListener("input",function(o){const r=new Date(o.target.value).getUTCDay();[0].includes(r)?(o.target.value="",d("Los domingos no abrimos.","error",".formulario")):c.fecha=o.target.value})}function S(){document.querySelector("#hora").addEventListener("input",function(o){const a=o.target.value.split(":")[0];a<9||a>18?(o.target.value="",d("hora no valida, cerrado","error",".formulario")):c.hora=o.target.value})}async function b(){try{const o=await(await fetch(`${p}/servicios`)).json();g(o)}catch(e){console.log(e)}}async function C(){const e=document.querySelector("#nombre").value,o=document.querySelector("#apellido").value,r=document.querySelector("#telefono").value,a=document.querySelector("#email").value;if(c.nombre=e,e===""||o===""||r===""||a==="")return d("Todos los campos son obligatorios","error",".formulario");const t=new FormData;t.append("nombre",e),t.append("apellido",o),t.append("email",a),t.append("contrase\xF1a",r),t.append("telefono",r),t.append("admin",0),t.append("confirmado",0),t.append("token","");try{const s=await(await fetch(`${p}/usuarios`,{method:"POST",body:t})).json();return s.tipo==="error"?console.log("Error creando el usuario"):(console.log("Usuario creado correctamente"),{id:s.usuario_id.id,name:`${e} ${o}`})}catch(n){console.log(n)}}async function L(){document.querySelector("#reservarCita").addEventListener("click",async e=>{e.preventDefault();const{id:o,name:r}=await C();l=o;const{fecha:a,hora:t,servicios:n}=c,s=n.map(u=>u.id),i=new FormData;i.append("fecha",a),i.append("hora",t),i.append("usuarioId",l),i.append("servicios",s.toString());try{const m=await(await fetch(`${p}/citas`,{method:"POST",body:i})).json();m.respuesta.tipo==="exito"&&f.fire("Muy bien!",m.respuesta.mensaje,"success").then(()=>{window.location.href=`/pages/citas/citas.html?user=${l}&name=${r}`})}catch{f.fire({icon:"error",title:"Oops...",text:"Hubo un error al guardar la cita"})}})}
